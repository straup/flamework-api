<?php

	# This is a non-standard global config without an 'api_' suffix that
	# we are going to assign below...

	$GLOBALS['cfg']['site_abs_root_url'] = '';

	# API stuff

	$GLOBALS['cfg']['enable_feature_api'] = 1;

	$GLOBALS['cfg']['api_require_ssl'] = 1;
	$GLOBALS['cfg']['api_subdomain'] = 'api';

	$GLOBALS['cfg']['api_server_scheme'] = ($GLOBALS['cfg']['api_require_ssl']) ? 'https' : 'http';
	$GLOBALS['cfg']['api_server_name'] = parse_url($GLOBALS['cfg']['abs_root_url'], 1);

	# If I have an API specific subdomain/prefix then check to see if I am already
	# running on that host; if not then update the 'api_server_name' config

	if (($GLOBALS['cfg']['api_subdomain']) && (! preg_match("/^{$GLOBALS['cfg']['api_subdomain']}\.(?:.*)/", $GLOBALS['cfg']['api_server_name']))){
		$GLOBALS['cfg']['api_server_name'] = $GLOBALS['cfg']['api_subdomain'] . "." . $GLOBALS['cfg']['api_server_name'];
	}

	# Build the 'api_abs_root_url' based on everything above

	$GLOBALS['cfg']['api_abs_root_url'] = "{$GLOBALS['cfg']['api_server_scheme']}://{$GLOBALS['cfg']['api_server_name']}" . "/";

	# If I have an API specific subdomain/prefix then check to see if I am already
	# running on that host; if I am then update the 'site_abs_root_url' config and
	# use it in your code accordingly.

	if (($GLOBALS['cfg']['api_subdomain']) && (preg_match("/{$GLOBALS['cfg']['api_subdomain']}\.(?:.*)/", $GLOBALS['cfg']['api_server_name']))){
		$GLOBALS['cfg']['site_abs_root_url'] = str_replace("{$GLOBALS['cfg']['api_subdomain']}.", "", $GLOBALS['cfg']['site_abs_root_url']);
	}

	else {
		$GLOBALS['cfg']['site_abs_root_url'] = $GLOBALS['cfg']['abs_root_url'];
	}

	$GLOBALS['cfg']['api_auth_type'] = 'oauth2';

	$GLOBALS['cfg']['enable_feature_api_documentation'] = 1;
	$GLOBALS['cfg']['enable_feature_api_logging'] = 1;
	$GLOBALS['cfg']['enable_feature_api_throttling'] = 0;

	$GLOBALS['cfg']['enable_feature_api_require_keys'] = 0;		# because oauth2...
	$GLOBALS['cfg']['enable_feature_api_register_keys'] = 1;

	$GLOBALS['cfg']['enable_feature_api_delegated_auth'] = 1;
	$GLOBALS['cfg']['enable_feature_api_authenticate_self'] = 1;

	$GLOBALS['cfg']['api_per_page_default'] = 100;
	$GLOBALS['cfg']['api_per_page_max'] = 500;

?>